extends ../layout

block content
    h1.text-center Configurazione
    ul.nav.nav-tabs(role='tablist')
        li.nav-item
            a.nav-link.active(data-toggle='tab' href='#stat') Stazioni
        li.nav-item
            a.nav-link(data-toggle='tab' href='#user') Utenti


    div.tab-content

        div.container.tab-pane.active(id='stat')
            div.row.justify-content-md-center.little-margin-top
                form.form-row.padding-bottom(method='POST' action='/config/station/new_station')
                    div.col-auto.form-group
                        label(for='StationName') Nome:
                        input.form-control(id='StationName' name='StationName' type='text' placeholder= 'Inserisci nome')
                    div.col-auto.form-group
                        label(for='Location') Luogo:
                        input.form-control(id='Location' name='Location' type='text' placeholder= 'Inserisci Luogo')
                    div.col-auto.form-group
                        label(for='Altitude') Altitudine:
                        input.form-control(id='Altitude' name='Altitude' type='text' placeholder= 'Inserisci Altitudine')
                    div.col-auto.form-group
                        label(for='IP') Indirizzo IP:
                        input.form-control(id='IP' name='IP' type='text' placeholder= 'Inserisci IP')
                    div.col-auto.form-group
                        button.btn.btn-m.btn-primary(type='submit' style='margin-top: 32px;') CREA


            table.table.table-bordered
                thead
                    tr.text-center
                        th ID
                        th Nome
                        th Luogo
                        th Altitudine (m)
                        th Indirizzo IP
                        th Token
                        th Modifica

                each item in station
                    tr.text-center
                        td.align-middle#thId=item.Id
                        td.align-middle#thName=item.StationName
                        td.align-middle#thLocation=item.Location
                        td.align-middle#thAltitude=item.Altitude
                        td.align-middle#thIP=item.IP
                        td.align-middle#thToken=item.Token
                        td
                            div
                                form.form-inline.d-inline(method='POST' action='/config/station/delete_station')
                                    input.form-control.form-margin.d-inline(name='Id' type='hidden' value=item.Id)
                                    button.btn.btn-sm.btn-danger.form-margin.d-inline(type='submit') ELIMINA
                                button.btn.btn-sm.btn-info.form-margin.d-inline.modifyButton.deleteButton MODIFICA

                    div.modal.fade(id="modifyModal" role="dialog")
                        script.
                            $(".modifyButton").click(function (e) {
                                $("#modifyModal").modal()

                                $("#ModifyId").val($(event.target).closest('tr').find("#thId").text());
                                $("#ModifyStationName").val($(event.target).closest('tr').find("#thName").text());
                                $("#ModifyLocation").val($(event.target).closest('tr').find("#thLocation").text());
                                $("#ModifyAltitude").val($(event.target).closest('tr').find("#thAltitude").text());
                                $("#ModifyIP").val($(event.target).closest('tr').find("#thIP").text());
                            })
                        div.modal-dialog

                            div.modal-content
                                div.modal-header
                                    h4.modal-title Modifica Stazione
                                    button.close(data-dismiss="modifyModal") X

                                div.modal-body
                                    div.container.tab-pane.active(id='stat')
                                        form.form-inline.padding-bottom(method='POST' action='/config/station/modify_station')
                                            input.form-control.form-margin.d-inline(id='ModifyId' name='ModifyId' type='hidden')
                                            label(for='ModifyStationName') Nome:
                                            input.form-control.form-margin(id='ModifyStationName' name='ModifyStationName' type='text')

                                            label(for='ModifyLocation') Luogo:
                                            input.form-control.form-margin(id='ModifyLocation' name='ModifyLocation' type='text')

                                            label(for='ModifyAltitude') Altitudine:
                                            input.form-control.form-margin(id='ModifyAltitude' name='ModifyAltitude' type='text')

                                            label(for='ModifyIP') Indirizzo IP:
                                            input.form-control.form-margin(id='ModifyIP' name='ModifyIP' type='text')

                                            button.btn.btn-m.btn-primary.form-margin(type='submit') Modifica

        div.container.tab-pane(id='user')
            div.row.justify-content-md-center.little-margin-top
                form.form-row.padding-bottom(method='POST' action='/user/new_user')
                    form.form-row.padding-bottom(method='POST' action='/user/new_user')
                        div.col-auto.form-group
                            label(for='Email') Email:
                            input.form-control(id='Email' name='Email' type='text' placeholder= 'Inserisci email')
                        div.col-auto.form-group
                            label(for='Name') Nome:
                            input.form-control(id='Name' name='Name' type='text' placeholder= 'Inserisci nome')
                        div.col-auto.form-group
                            label(for='Password') Password:
                            input.form-control(id='Password' name='Password' type='password' placeholder= 'Inserisci password')
                        div.col-auto.form-group
                            label(for='PasswordConfirm') Conferma Password:
                            input.form-control(id='PasswordConfirm' name='PasswordConfirm' type='password' placeholder= 'reinserisci password')
                        div.col-auto.form-group
                            button.btn.btn-m.btn-primary(type='submit' style='margin-top: 32px;') CREA

            table.table.table-bordered
                thead
                    tr.text-center
                        th ID
                        th Email
                        th Nome
                        th Modifica

                each item in user
                    tr.text-center
                        td.align-middle#thUserId=item.Id
                        td.align-middle#thUserEmail=item.Email
                        td.align-middle#thUserName=item.Name
                        td
                            div
                                form.form-inline.d-inline(method='POST' action='/user/delete_user')
                                    input.form-control.form-margin.d-inline(name='UserId' type='hidden' value=item.Id)
                                    button.btn.btn-sm.btn-danger.form-margin.d-inline(type='submit') ELIMINA
                                button.btn.btn-sm.btn-info.form-margin.d-inline.modifyUserButton.deleteButton MODIFICA

                    div.modal.fade(id="userModal" role="dialog")
                        script.
                            $(".modifyUserButton").click(function (e) {
                                $("#userModal").modal()
                                $("#ModifyUserId").val($(event.target).closest('tr').find("#thUserId").text());
                                $("#ModifyUserName").val($(event.target).closest('tr').find("#thUserName").text());
                                $("#ModifyUserEmail").val($(event.target).closest('tr').find("#thUserEmail").text());
                            })
                        div.modal-dialog

                            div.modal-content
                                div.modal-header
                                    h4.modal-title Modifica
                                    button.close(data-dismiss="userModal") X

                                div.modal-body
                                    div.container.tab-pane.active(id='stat')
                                        form.form-inline.padding-bottom(method='POST' action='/user/modify_user')
                                            input.form-control.form-margin.d-inline(id='ModifyUserId' name='ModifyUserId' type='hidden')
                                            label(for='ModifyUserName') Nome:
                                            input.form-control.form-margin(id='ModifyUserName' name='ModifyUserName' type='text')

                                            label(for='ModifyUserEmail') Email:
                                            input.form-control.form-margin(id='ModifyUserEmail' name='ModifyUserEmail' type='mail')

                                            label(for='ModifyUserPassword') Password:
                                            input.form-control.form-margin(id='ModifyUserPassword' name='ModifyUserPassword' type='password')

                                            label(for='ModifyUserPasswordConfirm') Conferma Password:
                                            input.form-control.form-margin(id='ModifyUserPasswordConfirm' name='ModifyUserPasswordConfirm' type='password')

                                            button.btn.btn-m.btn-primary.form-margin(type='submit') Modifica